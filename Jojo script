--// JOJO BA ULTIMATE v2 | Delta Executor
--// Auto Farm + Stand Sniper + Shiny Catcher
--// PolimÃ³rfico | Otimizado PC & Mobile

local function _p()local c="qwrtypsdfghjklzxcvbnm"local r=""for i=1,math.random(5,8)do local x=math.random(1,#c)r=r..c:sub(x,x)end return"_"..r..math.random(10,99)end
local _={a=_p(),b=_p(),c=_p(),d=_p(),e=_p(),f=_p()}

local plrs=game:GetService("Players")
local rs=game:GetService("RunService")
local uis=game:GetService("UserInputService")
local ts=game:GetService("TweenService")
local rps=game:GetService("ReplicatedStorage")
local lp=plrs.LocalPlayer
local pg=lp.PlayerGui

--// ============ STANDS DATABASE ============
local STANDS={
    -- NORMAIS
    "Star Platinum","The World","Crazy Diamond","Gold Experience",
    "King Crimson","Sticky Fingers","Purple Haze","Aerosmith",
    "Killer Queen","Echoes","Hierophant Green","Magicians Red",
    "Silver Chariot","The Hand","Cream","Whitesnake",
    "C-Moon","Made in Heaven","Stone Free","Weather Report",
    "Tusk Act 1","Tusk Act 2","Tusk Act 3","Tusk Act 4",
    "D4C","Dirty Deeds Done Dirt Cheap","Ball Breaker",
    "Soft & Wet","King Nothing","Paisley Park",
    "Star Platinum: The World","Gold Experience Requiem",
    "King Crimson Requiem","Chariot Requiem","Silver Chariot Requiem",
    "Killer Queen: Bites The Dust","Echoes Act 3",
    "The World Over Heaven","Star Platinum Over Heaven",
    "Six Pistols","Beach Boy","Grateful Dead","Baby Face",
    "White Album","Metallica","Green Day","Oasis",
    "Scary Monsters","Catch The Rainbow","Mandom",
    "Wonder Of U","Speed King","Nut King Call",
    "Hermit Purple","Tower Of Gray","Dark Blue Moon",
    "Strength","Emperor","Hanged Man","Justice",
    "Lovers","Sun","Death 13","Judgement","High Priestess",
    "Iggy The Fool","Geb","Khnum","Tohth","Anubis",
    "Bastet","Sethan","Osiris","Atum","Tenore Sax",
    "Bohemian Rhapsody","Sky High","Underworld",
    "Jail House Lock","Highway To Hell","Limp Bizkit",
    "Jumpin Jack Flash","Manhattan Transfer","Planet Waves",
    "Dragon Dream","Yo-Yo Ma","Survivor","Marilyn Manson",
    "Burning Down The House","Kiss","Diver Down",
    "Foo Fighters","Green Green Grass Of Home"
}

local SHINIES={
    -- SHINIES / SKINS (param automatico)
    "Star Platinum: Stone Ocean","Star Platinum OVA",
    "The World OVA","The World: Alternative Universe",
    "Crazy Diamond: Manga","Gold Experience: Manga",
    "King Crimson: Manga","King Crimson: Alternate",
    "Killer Queen: Manga","Killer Queen: Shadow",
    "Purple Haze: Distortion","Silver Chariot: Anubis",
    "Hierophant Green: Manga","Magicians Red: Manga",
    "The Hand: Manga","Cream: Manga","Whitesnake: Manga",
    "C-Moon: Manga","Made in Heaven: Manga",
    "Star Platinum: Retro","The World: Retro",
    "Tusk Act 4: Love Train","D4C: Love Train",
    "Gold Experience Requiem: Manga","Chariot Requiem: Manga",
    "Stone Free: Manga","Weather Report: Manga",
    "Sticky Fingers: Manga","Aerosmith: Manga",
    "Scary Monsters: Alternate","Cream Starter",
    "Star Platinum: Midnight","The World: Cyber",
    "King Crimson: Requiem Alternate","Killer Queen: Sheer Heart",
    "TWOH: Manga","SPOH: Manga",
    "Soft & Wet: Go Beyond","Wonder Of U: Manga",
    "SPTW: Greatest High","SPTW: Manga",
    "KCR: Alternate","GER: Alternate",
    "MIH: Alternate","D4C:LT Manga",
    "Tusk Act 4: Johnny","SCR: Manga",
    "Anubis: Manga","Chariot: Requiem Silver",
    "Cream: Void","The Hand: Za Hando",
    "SP: Heritage","TW: Heritage","TW: Shadow",
    "SP: Shadow","KC: Kcr Crimson","GE: Vento Aureo",
    "SF: Bucciarati","PH: Fugo","BB: Gyro",
    "SC: Polnareff","HG: Kakyoin","MR: Avdol",
    "Iggy: OVA","DIO: Shadow","Jotaro: Heritage"
}

local ALL_STANDS={}
for _,v in ipairs(STANDS)do ALL_STANDS[v]={shiny=false}end
for _,v in ipairs(SHINIES)do ALL_STANDS[v]={shiny=true}end

--// ============ CONFIG ============
local cfg={
    farm=false,
    sniper=false,
    autoShiny=true,
    targetStand=nil,
    farmDelay=0.1,
    sniperSpeed=50,
}

--// ============ GUI ============
local function makeGui()
    local old=pg:FindFirstChild("JJBA_UI")
    if old then old:Destroy()end

    local sg=Instance.new("ScreenGui")
    sg.Name="JJBA_UI"
    sg.ResetOnSpawn=false
    sg.ZIndexBehavior=Enum.ZIndexBehavior.Sibling
    sg.Parent=pg

    -- Drag system
    local function drag(f)
        local d,dx,dy=false,0,0
        f.InputBegan:Connect(function(i)
            if i.UserInputType==Enum.UserInputType.MouseButton1 or i.UserInputType==Enum.UserInputType.Touch then
                d=true
                dx=i.Position.X-f.AbsolutePosition.X
                dy=i.Position.Y-f.AbsolutePosition.Y
            end
        end)
        f.InputEnded:Connect(function(i)
            if i.UserInputType==Enum.UserInputType.MouseButton1 or i.UserInputType==Enum.UserInputType.Touch then d=false end
        end)
        uis.InputChanged:Connect(function(i)
            if d and(i.UserInputType==Enum.UserInputType.MouseMovement or i.UserInputType==Enum.UserInputType.Touch)then
                f.Position=UDim2.new(0,i.Position.X-dx,0,i.Position.Y-dy)
            end
        end)
    end

    -- Main frame
    local mf=Instance.new("Frame")
    mf.Size=UDim2.new(0,320,0,420)
    mf.Position=UDim2.new(0.5,-160,0.5,-210)
    mf.BackgroundColor3=Color3.fromRGB(15,15,25)
    mf.BorderSizePixel=0
    mf.Parent=sg
    mf.ClipsDescendants=true
    local mc=Instance.new("UICorner",mf)mc.CornerRadius=UDim.new(0,12)
    local ms=Instance.new("UIStroke",mf)ms.Color=Color3.fromRGB(120,50,255)ms.Thickness=1.5

    -- Title bar
    local tb=Instance.new("Frame")
    tb.Size=UDim2.new(1,0,0,40)
    tb.BackgroundColor3=Color3.fromRGB(20,15,40)
    tb.BorderSizePixel=0
    tb.Parent=mf
    local tc=Instance.new("UICorner",tb)tc.CornerRadius=UDim.new(0,12)
    drag(tb)

    local tl=Instance.new("TextLabel")
    tl.Size=UDim2.new(1,-50,1,0)
    tl.Position=UDim2.new(0,12,0,0)
    tl.BackgroundTransparency=1
    tl.Text="â­ JOJO BA ULTIMATE v2"
    tl.TextColor3=Color3.fromRGB(200,150,255)
    tl.TextSize=14
    tl.Font=Enum.Font.GothamBold
    tl.TextXAlignment=Enum.TextXAlignment.Left
    tl.Parent=tb

    -- Close btn
    local cb=Instance.new("TextButton")
    cb.Size=UDim2.new(0,30,0,30)
    cb.Position=UDim2.new(1,-35,0,5)
    cb.BackgroundColor3=Color3.fromRGB(255,50,50)
    cb.Text="X"
    cb.TextColor3=Color3.new(1,1,1)
    cb.TextSize=14
    cb.Font=Enum.Font.GothamBold
    cb.Parent=tb
    Instance.new("UICorner",cb).CornerRadius=UDim.new(0,8)
    cb.MouseButton1Click:Connect(function()mf.Visible=false end)

    -- Content scroll
    local sf=Instance.new("ScrollingFrame")
    sf.Size=UDim2.new(1,-16,1,-48)
    sf.Position=UDim2.new(0,8,0,44)
    sf.BackgroundTransparency=1
    sf.ScrollBarThickness=3
    sf.ScrollBarImageColor3=Color3.fromRGB(120,50,255)
    sf.BorderSizePixel=0
    sf.CanvasSize=UDim2.new(0,0,0,0)
    sf.AutomaticCanvasSize=Enum.AutomaticSize.Y
    sf.Parent=mf
    local sl=Instance.new("UIListLayout",sf)
    sl.Padding=UDim.new(0,6)
    sl.SortOrder=Enum.SortOrder.LayoutOrder

    -- Helper: Section label
    local function secLabel(txt,order)
        local l=Instance.new("TextLabel")
        l.Size=UDim2.new(1,0,0,22)
        l.BackgroundTransparency=1
        l.Text=txt
        l.TextColor3=Color3.fromRGB(150,120,255)
        l.TextSize=12
        l.Font=Enum.Font.GothamBold
        l.TextXAlignment=Enum.TextXAlignment.Left
        l.LayoutOrder=order
        l.Parent=sf
        return l
    end

    -- Helper: Toggle button
    local function togBtn(txt,default,order,cb2)
        local f=Instance.new("Frame")
        f.Size=UDim2.new(1,0,0,34)
        f.BackgroundColor3=Color3.fromRGB(22,18,40)
        f.BorderSizePixel=0
        f.LayoutOrder=order
        f.Parent=sf
        Instance.new("UICorner",f).CornerRadius=UDim.new(0,8)

        local l=Instance.new("TextLabel")
        l.Size=UDim2.new(1,-60,1,0)
        l.Position=UDim2.new(0,10,0,0)
        l.BackgroundTransparency=1
        l.Text=txt
        l.TextColor3=Color3.fromRGB(200,200,220)
        l.TextSize=12
        l.Font=Enum.Font.Gotham
        l.TextXAlignment=Enum.TextXAlignment.Left
        l.Parent=f

        local b=Instance.new("TextButton")
        b.Size=UDim2.new(0,44,0,22)
        b.Position=UDim2.new(1,-50,0.5,-11)
        b.BackgroundColor3=default and Color3.fromRGB(80,200,80) or Color3.fromRGB(80,80,100)
        b.Text=default and "ON" or "OFF"
        b.TextColor3=Color3.new(1,1,1)
        b.TextSize=11
        b.Font=Enum.Font.GothamBold
        b.Parent=f
        Instance.new("UICorner",b).CornerRadius=UDim.new(0,6)

        local state=default
        b.MouseButton1Click:Connect(function()
            state=not state
            b.Text=state and "ON" or "OFF"
            b.BackgroundColor3=state and Color3.fromRGB(80,200,80) or Color3.fromRGB(80,80,100)
            cb2(state)
        end)
        return b
    end

    -- Helper: Status label
    local function statusLabel(order)
        local l=Instance.new("TextLabel")
        l.Size=UDim2.new(1,0,0,20)
        l.BackgroundTransparency=1
        l.Text="Stand: Nenhum selecionado"
        l.TextColor3=Color3.fromRGB(255,200,50)
        l.TextSize=11
        l.Font=Enum.Font.GothamBold
        l.TextXAlignment=Enum.TextXAlignment.Left
        l.LayoutOrder=order
        l.Parent=sf
        return l
    end

    -- ===== BUILD UI =====
    secLabel("ðŸŽ® CONTROLES",1)

    togBtn("ðŸŒ¾ Auto Farm Itens",cfg.farm,2,function(v)
        cfg.farm=v
    end)

    togBtn("ðŸŽ¯ Stand Sniper (Arrow)",cfg.sniper,3,function(v)
        cfg.sniper=v
    end)

    togBtn("âœ¨ Auto Shiny Catch",cfg.autoShiny,4,function(v)
        cfg.autoShiny=v
    end)

    secLabel("ðŸ“Š STATUS",5)
    local stLbl=statusLabel(6)

    secLabel("ðŸŽ¯ ESCOLHER STAND ALVO",7)

    -- Search bar
    local searchF=Instance.new("Frame")
    searchF.Size=UDim2.new(1,0,0,30)
    searchF.BackgroundColor3=Color3.fromRGB(22,18,40)
    searchF.BorderSizePixel=0
    searchF.LayoutOrder=8
    searchF.Parent=sf
    Instance.new("UICorner",searchF).CornerRadius=UDim.new(0,8)

    local searchBox=Instance.new("TextBox")
    searchBox.Size=UDim2.new(1,-16,1,0)
    searchBox.Position=UDim2.new(0,8,0,0)
    searchBox.BackgroundTransparency=1
    searchBox.Text=""
    searchBox.PlaceholderText="ðŸ” Buscar stand..."
    searchBox.PlaceholderColor3=Color3.fromRGB(100,100,130)
    searchBox.TextColor3=Color3.new(1,1,1)
    searchBox.TextSize=12
    searchBox.Font=Enum.Font.Gotham
    searchBox.TextXAlignment=Enum.TextXAlignment.Left
    searchBox.ClearTextOnFocus=false
    searchBox.Parent=searchF

    -- Stands list container
    local standFrame=Instance.new("Frame")
    standFrame.Size=UDim2.new(1,0,0,200)
    standFrame.BackgroundColor3=Color3.fromRGB(12,10,22)
    standFrame.BorderSizePixel=0
    standFrame.LayoutOrder=9
    standFrame.ClipsDescendants=true
    standFrame.Parent=sf
    Instance.new("UICorner",standFrame).CornerRadius=UDim.new(0,8)

    local standScroll=Instance.new("ScrollingFrame")
    standScroll.Size=UDim2.new(1,-4,1,-4)
    standScroll.Position=UDim2.new(0,2,0,2)
    standScroll.BackgroundTransparency=1
    standScroll.ScrollBarThickness=3
    standScroll.ScrollBarImageColor3=Color3.fromRGB(120,50,255)
    standScroll.BorderSizePixel=0
    standScroll.CanvasSize=UDim2.new(0,0,0,0)
    standScroll.AutomaticCanvasSize=Enum.AutomaticSize.Y
    standScroll.Parent=standFrame
    local standLayout=Instance.new("UIListLayout",standScroll)
    standLayout.Padding=UDim.new(0,2)

    local standButtons={}

    local function buildStandList(filter)
        for _,b in pairs(standButtons)do b:Destroy()end
        standButtons={}

        -- Shinies first
        local sorted={}
        for _,v in ipairs(SHINIES)do
            if not filter or filter=="" or v:lower():find(filter:lower())then
                table.insert(sorted,{name=v,shiny=true})
            end
        end
        for _,v in ipairs(STANDS)do
            if not filter or filter=="" or v:lower():find(filter:lower())then
                table.insert(sorted,{name=v,shiny=false})
            end
        end

        for i,data in ipairs(sorted)do
            local btn=Instance.new("TextButton")
            btn.Size=UDim2.new(1,-6,0,26)
            btn.BackgroundColor3=data.shiny and Color3.fromRGB(40,30,15) or Color3.fromRGB(25,22,45)
            btn.Text=(data.shiny and "âœ¨ " or "   ")..data.name
            btn.TextColor3=data.shiny and Color3.fromRGB(255,215,0) or Color3.fromRGB(180,180,200)
            btn.TextSize=11
            btn.Font=data.shiny and Enum.Font.GothamBold or Enum.Font.Gotham
            btn.TextXAlignment=Enum.TextXAlignment.Left
            btn.TextTruncate=Enum.TextTruncate.AtEnd
            btn.AutoButtonColor=true
            btn.LayoutOrder=i
            btn.Parent=standScroll
            Instance.new("UICorner",btn).CornerRadius=UDim.new(0,4)
            Instance.new("UIPadding",btn).PaddingLeft=UDim.new(0,6)

            if cfg.targetStand==data.name then
                btn.BackgroundColor3=Color3.fromRGB(60,20,120)
                local sel=Instance.new("UIStroke",btn)
                sel.Color=Color3.fromRGB(150,80,255)
                sel.Thickness=1
            end

            btn.MouseButton1Click:Connect(function()
                cfg.targetStand=data.name
                stLbl.Text="Stand: "..data.name..(data.shiny and " âœ¨" or "")
                stLbl.TextColor3=data.shiny and Color3.fromRGB(255,215,0) or Color3.fromRGB(150,255,150)
                buildStandList(searchBox.Text)
            end)

            table.insert(standButtons,btn)
        end
    end

    buildStandList("")
    searchBox:GetPropertyChangedSignal("Text"):Connect(function()
        buildStandList(searchBox.Text)
    end)

    -- Info
    secLabel("ðŸ“± INFO",10)
    local info=Instance.new("TextLabel")
    info.Size=UDim2.new(1,0,0,50)
    info.BackgroundTransparency=1
    info.Text="Mobile: Arraste o menu\nF6=Mostrar/Esconder menu\nAuto Shiny: Para em QUALQUER shiny"
    info.TextColor3=Color3.fromRGB(120,120,150)
    info.TextSize=10
    info.Font=Enum.Font.Gotham
    info.TextXAlignment=Enum.TextXAlignment.Left
    info.TextWrapped=true
    info.LayoutOrder=11
    info.Parent=sf

    -- Toggle btn mobile (floating)
    local togF=Instance.new("TextButton")
    togF.Size=UDim2.new(0,40,0,40)
    togF.Position=UDim2.new(0,10,0.5,-20)
    togF.BackgroundColor3=Color3.fromRGB(120,50,255)
    togF.Text="â­"
    togF.TextSize=18
    togF.Font=Enum.Font.GothamBold
    togF.TextColor3=Color3.new(1,1,1)
    togF.Parent=sg
    Instance.new("UICorner",togF).CornerRadius=UDim.new(0,20)
    drag(togF)
    togF.MouseButton1Click:Connect(function()
        mf.Visible=not mf.Visible
    end)

    return sg,stLbl,mf
end

local gui,stLbl,mainFrame=makeGui()

--// ============ ARROW SNIPER ============
-- Detecta a GUI de flechas rolando e para no stand certo
local function findArrowGui()
    -- Procura GUIs de arrow/roulette no PlayerGui
    for _,g in pairs(pg:GetChildren())do
        if g:IsA("ScreenGui") then
            for _,f in pairs(g:GetDescendants())do
                -- Procura frames que parecem roulette
                if f:IsA("Frame") and f.Visible then
                    local scroll=f:FindFirstChildWhichIsA("ScrollingFrame")
                    if scroll then return f,scroll end
                    -- Procura ImageLabels que estao rolando (stands na roulette)
                    local imgs={}
                    for _,c in pairs(f:GetDescendants())do
                        if c:IsA("ImageLabel") or c:IsA("TextLabel") then
                            table.insert(imgs,c)
                        end
                    end
                    if #imgs>3 then return f,nil,imgs end
                end
            end
        end
    end
    return nil
end

local function getStandFromGui(frame)
    if not frame then return nil end
    -- Tenta encontrar o nome do stand na GUI
    for _,c in pairs(frame:GetDescendants())do
        if c:IsA("TextLabel") and c.Text~="" then
            local txt=c.Text
            if ALL_STANDS[txt]then return txt end
            -- Busca parcial
            for name,_ in pairs(ALL_STANDS)do
                if txt:lower():find(name:lower()) or name:lower():find(txt:lower())then
                    return name
                end
            end
        end
    end
    return nil
end

local function isShiny(name)
    if not name then return false end
    for _,s in ipairs(SHINIES)do
        if name:lower()==s:lower() or name:lower():find(s:lower())then
            return true
        end
    end
    return false
end

--// ============ ARROW ROULETTE HOOK ============
local function hookArrowRoulette()
    -- Monitora mudancas no PlayerGui para detectar roulette
    pg.DescendantAdded:Connect(function(desc)
        if not cfg.sniper and not cfg.autoShiny then return end

        task.wait(0.1)

        -- Detecta se e uma GUI de roulette/arrow
        if desc:IsA("Frame") or desc:IsA("ScreenGui")then
            task.spawn(function()
                -- Espera a roulette comecar a rodar
                task.wait(0.5)

                local attempts=0
                while attempts<200 do
                    attempts=attempts+1
                    task.wait(0.05)

                    -- Tenta encontrar o stand atual na roulette
                    local currentStand=nil

                    -- Busca em todos os TextLabels visiveis
                    for _,gui2 in pairs(pg:GetDescendants())do
                        if gui2:IsA("TextLabel") and gui2.Visible and gui2.Text~="" then
                            local txt=gui2.Text:gsub("^%s+",""):gsub("%s+$","")
                            if ALL_STANDS[txt]then
                                currentStand=txt
                                break
                            end
                            for name,_ in pairs(ALL_STANDS)do
                                if txt:lower()==name:lower()then
                                    currentStand=name
                                    break
                                end
                            end
                            if currentStand then break end
                        end
                    end

                    if currentStand then
                        local shouldStop=false
                        local reason=""

                        -- Auto Shiny: para em qualquer shiny
                        if cfg.autoShiny and isShiny(currentStand)then
                            shouldStop=true
                            reason="SHINY DETECTADO"
                        end

                        -- Sniper: para no stand alvo
                        if cfg.sniper and cfg.targetStand then
                            if currentStand:lower()==cfg.targetStand:lower()then
                                shouldStop=true
                                reason="STAND ALVO"
                            end
                        end

                        if shouldStop then
                            -- Tenta clicar/confirmar
                            for _,btn in pairs(pg:GetDescendants())do
                                if btn:IsA("TextButton") or btn:IsA("ImageButton")then
                                    if btn.Visible then
                                        local t=btn.Text or ""
                                        if t:lower():find("confirm") or t:lower():find("accept")
                                            or t:lower():find("ok") or t:lower():find("keep")
                                            or t:lower():find("sim") or t:lower():find("yes")
                                            or t:lower():find("confirmar") or t:lower():find("aceitar")then
                                            -- Foca e clica
                                            pcall(function()
                     
